{% extends 'layout.twig' %}
{% block title %} Task Details{% endblock %}



{% block contant_wrapper %}

    <div class="row">
        <div class="col-md-12">
            <h4 class="pull-left text-uppercase">Task Details</h4>
            <div class="pull-right btn-toolbar">
                <a href="/task/create" class="btn btn-info btn-group  text-uppercase">
                    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Create
                </a>
                <a href="" class="btn btn-warning btn-group  text-uppercase">
                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Update
                </a>


                <a href="/task/list" class="btn btn-info btn-group  text-uppercase">
                    <span class="glyphicon glyphicon-list" aria-hidden="true"></span> Task
                </a>
            </div>
        </div>
    </div>
    <hr>
    <!-- /.row -->
    <div class="row">
        <div class="col-lg-8">
            <div class="task-hero">
                <div class="section">
                    {% if  details.status==4 %}
                    <form action="/task/admin_status" method="post">
                        <select name="status" id="inputID" class="form-control" required>
                            <option value=""> -- Select One --</option>
                            <option value="1">Complete</option>
                            <option value="2">Incomplete</option>
                        </select>
                    </form>
                    {% endif %}
                    <h5 class="text-primary">Title:</h5>
                    <p>{{ details.title }}</p>
                </div>
                <div class="section">
                    <h5 class="text-primary">Description:</h5>
                    {{ details.description |raw }}
                </div>

                {% if attached is empty %}

                {% else %}
                    <div class="section">
                        <div class="pull-right btn-toolbar">
                            <a href="/attach-zip/{{ details.task_id }}" class="btn btn-info btn-group  text-uppercase">
                                <span class="glyphicon glyphicon-download" aria-hidden="true"></span> Download as zip
                            </a>
                        </div>
                        <br>
                        <h5 class="text-primary">Attachment:</h5>
                        <ul class="list-group">

                            {% for attachment in attached %}
                                <li class="list-group-item">
                                    <b>{{ loop.index }}.</b>
                                    {% set fileName = attachment.attached_path |split('/') %}
                                    {{ fileName[1] }}
                                    {#{{ dump(attachment.attached_path |split('/')) }}#}
                                    <a href="/{{ attachment.attached_path }}"
                                       class="btn btn-link pull-right">Download</a>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="pull-right btn-toolbar">
                        <a href="/task/attached/{{ details.task_id }}" class="btn btn-link btn-group  text-uppercase">
                            <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add more files
                        </a>
                    </div>

                </div>
            </div>

            <h4 class="text-primary"><u>Comments:</u></h4>
          {#  {{ dump(session.user.0) }}#}
            {#{{ dump(all_comments) }}#}
            <dl>
                {% for commt in all_comments %}
                {#<dt>Posted By:   </dt>#}
                <dd>{{ commt.comments }}  -
                    {% if session.user.0.username == commt.username %}
                        <i style="color: green">{{ commt.username }}</i>
                        {% else %}
                    <i style="color: #FFA500">{{ commt.username }}</i>
                            {% endif %}
                        </dd><hr>
                 {% endfor %}
            </dl>
            <form method="post" action="/comment">
                <input type="hidden" value="{{ session.user.0.id }}" name="user_id">
                <input type="hidden" value="{{ session.user.0.username }}" name="username">
                <input type="hidden" value="{{ details.task_id }}" name="task_id">
                <div class="form-group">
                    <textarea class="form-control" placeholder="Write your comment" name="comments"></textarea>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-success">Post</button>
                </div>
            </form>
        </div>
        <div class="col-lg-4">
            <table class="table table-responsive table-hover">
                <tr>
                    <td><b>Task Type:</b></td>
                    <td>
                        {% if  details.task_type==1 %}
                            Edit
                        {% elseif details.task_type==2 %}
                            Redesign
                        {% elseif details.task_type==3 %}
                            New
                        {% endif %}
                    </td>


                </tr>

                <tr>
                    <td><b>Assign From:</b></td>
                    <td>
                        {{ details.users_full_name }}
                    </td>
                </tr>


                <tr>
                    <td style="width:200px"><b>Assign To:</b></td>
                    <td>
                        {{ details.members_full_name }}
                    </td>
                </tr>

                <tr>
                    <td style="width:200px"><b>Client ID:</b></td>
                    <td>
                        {{ details.client_id }}
                    </td>
                </tr>

                <tr>
                    <td style="width:200px"><b>Task Status:</b></td>
                    <td>
                        {% if  details.status==1 %}
                            Complete
                        {% elseif details.status==2 %}
                            Incomplete
                        {% elseif  details.status==3 %}
                            Pending
                        {% elseif details.status==4 %}
                            Done
                        {% elseif details.status==5 %}
                            Invalid
                        {% endif %}
                    </td>
                </tr>

                <tr>
                    <td style="width:200px"><b>Created Date:</b></td>
                    <td>
                        {{ details.created_at|date('d M, Y') }}
                    </td>
                </tr>
            </table>

        </div>
    </div>


{% endblock %}